---

- block:

  #..............................................
  # These are the default inputs....no output!
  #
  - name: copy telegraf.d configuration files
    ansible.builtin.copy:
      src: telegraf.d
      dest: /etc/telegraf/

  #..............................................
  # Specialized inputs
  #
  - name: collect apache stats
    ansible.builtin.copy:
      src: apache.conf
      dest: /etc/telegraf/telegraf.d/apache.conf
    when: influx_apache

  - name: collect memcache stats
    ansible.builtin.copy:
      src: memcache.conf
      dest: /etc/telegraf/telegraf.d/memcache.conf
    when: influx_memcache

  - name: collect redis stats
    ansible.builtin.copy:
      src: redis.conf
      dest: /etc/telegraf/telegraf.d/redis.conf
    when: influx_redis

  - name: collect mariadb stats
    ansible.builtin.copy:
      src: mariadb.conf
      dest: /etc/telegraf/telegraf.d/mariadb.conf
    when: influx_mariadb

  #..............................................
  # Ouputs
  #

  - name: first output
    ansible.builtin.copy:
      src: output1.conf
      dest: /etc/telegraf/telegraf.d/output1.conf
    when: influx_output1

  - name: second output
    ansible.builtin.copy:
      src: output2.conf
      dest: /etc/telegraf/telegraf.d/output2.conf
    when: influx_output2

  become: true

